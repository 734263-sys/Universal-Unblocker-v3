<html>
<head>
    <title>Settings</title>
    <link rel="stylesheet" href="/css/homepage.css">
</head>
<body style="overflow-y: scroll;">
    <center>
        <br>
        <h2 class="header">
            Settings
        </h2>
        <br>
        <h2>
            Extended Name: <input id="namecheck" onclick='changename(this)' type="checkbox">
        </h2>
        <br>
        <h2>
            Prevent leaving the site: <input id="leavesiteprotection" onclick='leavesiteprotection(this)' type="checkbox">
        </h2>
        <br>
        <h2>
            AutoCloak: <input id="autocloak" onclick='autocloak(this)' type="checkbox">
        </h2>
        <br>
        <h2>
            Refresh splash msg: <button onclick="refreshSplashMsg()">Refresh</button>
        </h2>
        <br>
        <h2 class="header">
            Utilities
        </h2>
        <br>
        <h2>Open in new tab</h2>
        <br>
        <h2>
            <input class="inputtext" id="newtab" placeholder="https://www.google.com" type="text">
        </h2>
        <br>
        <button style="height: 50px;" onclick="openinnewtab()">Submit</button>
        <br><br>
        <h2>Open in current window</h2>
        <br>
        <h2>
            <input class="inputtext" id="currenttab" placeholder="https://www.google.com" type="text">
        </h2>
        <br>
        <button style="height: 50px;" onclick="openincurrentwindow()">Submit</button>
        <br><br>
        <h2>Open in about blank</h2> 
        <br>
        <h2>
            <input class="inputtext" id="aboutblanktab" placeholder="https://www.google.com" type="text">
        </h2>
        <br>
        <button style="height: 50px;" onclick="openinaboutblank()">Submit</button>
        <br><br>
        <h2>Set gradient color</h2> 
        <br>
        <h2>
            <input class="inputtext" id="backgroundcolor" placeholder="#ffffff" type="color">
        </h2>
        <br>
        <button style="height: 50px;" onclick="setbackgroundcolor()">Submit</button>
        <br><br>
        <h2>Set panic</h2> 
        <br>
        <h3>Url</h3>
        <h2>
            <input class="inputtext" id="panicurl" placeholder="https://classroom.google.com" type="text">
        </h2>
        <br>
        <h3>Key</h3>
        <h2>
            <input class="inputtext" id="panickey" placeholder="A" type="text">
        </h2>
        <br>
        <button style="height: 50px;" onclick="setpanickey()">Submit</button>
        <br><br>
        <h2 class="header">
            Cloaks
        </h2>
        <br>
        <h2>
            <button onclick="cloak('clever')">Clever</button><button onclick="cloak('drive')">Drive</button><button onclick="cloak('docs')">Docs</button><button onclick="cloak('classroom')">Classroom</button><button onclick="cloak('reset')">Reset</button>
        </h2>
        <br>
        <div align='center'>
            <img src='https://www.free-website-hit-counter.com/c.php?d=7&id=177023&s=16' border='0' alt='Free Website Hit Counter'></a><br>
        </div>
        <br><br>
    </center>
</body>
<script src="/js/cloak.js"></script>
<script>
const textOptions = [
    "If somethings not working check your chrome version!",
    "Fun fact! This site has been taken down 3 Time(s)",
    "Only tested on Chrome v114 & v120",
    "Join the discord server for new site URLs!",
    "Submit game suggestions in the discord server!",
    "Go to chrome://version to check your version!",
    "If the sites not updating clear your cache!",
    "School admins < literally anyone",
    "Javascript is overrated",
    "Updates... sometimes?",
    "Originally called PDFXPLOIT",
    "Discord. Join. Now.",
    "Made by a student for students :)",
    "Securly ver 2.97.55 :("
];

top.document.getElementById("randomtext").innerHTML = textOptions[Math.round(Math.random()*textOptions.length)]

function refreshSplashMsg(){
    top.document.getElementById("randomtext").innerHTML = textOptions[Math.round(Math.random()*textOptions.length)]
}

function aboutblank(){
    url = window.location
    win = window.open();
    win.document.body.style.margin = '0';
    win.document.body.style.height = '100vh';
    var embed = win.document.createElement('embed');
    embed.style.border = 'none';
    embed.style.width = '100%';
    embed.style.height = '100%';
    embed.style.margin = '0';
    embed.src = url;
    win.document.body.appendChild(embed);
}

function cloak(tocloak){
    localStorage.removeItem("cloak")
    if (tocloak == "clever"){
        localStorage.setItem("cloak", "clever");
    }
    if (tocloak == "drive"){
        localStorage.setItem("cloak", "drive");
    }
    if (tocloak == "docs"){
        localStorage.setItem("cloak", "docs");
    }
    if (tocloak == "classroom"){
        localStorage.setItem("cloak", "classroom");
    }
    if (tocloak == "reset"){
        localStorage.setItem("cloak", "reset");
    }
    top.document.location.reload()
}

function setbackgroundcolor(){
    // I would add checks here but I'm pretty sure the type="color" tag does that for me :)
    localStorage.setItem("backgroundColor", document.getElementById('backgroundcolor').value)
    top.document.location.reload()
}

function setpanickey(){
    console.log(localStorage.setItem("panicKey", document.getElementById("panickey").value))
    console.log(localStorage.setItem("panicUrl", document.getElementById("panicurl").value))
}

function openinaboutblank(){
    let abtab = document.getElementById("aboutblanktab").value
    url = abtab
    win = window.open();
    win.document.body.style.margin = '0';
    win.document.body.style.height = '100vh';
    var embed = win.document.createElement('embed');
    embed.style.border = 'none';
    embed.style.width = '100%';
    embed.style.height = '100%';
    embed.style.margin = '0';
    embed.src = url;
    win.document.body.appendChild(embed);
}

function openinnewtab(){
    let newtab = document.getElementById("newtab").value
    console.log(newtab)
    window.open(
        String(newtab),
        '_blank'
      );
}

function openincurrentwindow(){
    let newtab = document.getElementById("currenttab").value
    console.log(newtab)
    window.parent.location.href = String(newtab)
}
function changename(cb){
    if (cb.checked){
        localStorage.setItem("extendedName", true)
    } else{
        localStorage.setItem("extendedName", false)
    }
    changeVals()
    top.document.location.reload()
}

function leavesiteprotection(lp){
    if (lp.checked){
        localStorage.setItem("leaveSiteProtection", true)
    } else{
        localStorage.setItem("leaveSiteProtection", false)
    }
}

function autocloak(ac){
    if (ac.checked){
        localStorage.setItem("autoCloak", true)
    } else{
        localStorage.setItem("autoCloak", false)
    }
}
function changeVals() {
    // TODO Safely set the values only if the items exist in localStorage
    document.getElementById("panickey").value = localStorage.getItem("panicKey") || "";
    document.getElementById("panicurl").value = localStorage.getItem("panicUrl") || "";
    document.getElementById("leavesiteprotection").checked = localStorage.getItem("leaveSiteProtection") === "true";
    document.getElementById("namecheck").checked = localStorage.getItem("extendedName") === "true";
    document.getElementById("autocloak").checked = localStorage.getItem("autoCloak") === "true";
}

changeVals()
</script>
</html>